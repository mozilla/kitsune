{% extends "messages/base.html" %}
{% from "messages/includes/macros.html" import message_form with context %}
{% set title = _('New Message') %}
{% set crumbs = [(url('messages.inbox'), _('Messages')), (None, title)] %}
{% set active_tab = 'new' %}

{% block content %}
  <div class="sumo-page-section">
    <article class="main">
      <h1 class="text-display-md">{{ title }}</h1>

      <section id="new-message">
        {% if request.limited %}
        <div class="mzp-c-notification-bar mzp-t-warning warning-box">
          <button class="mzp-c-notification-bar-button" type="button"></button>
          <p>{{ _('You have exceeded the number of private messages that can be sent in a day.') }}</p>
        </div>
        {% endif %}

        <form action="" method="post">
          {% csrf_token %}

          {{ message_form(form) }}

          <div class="sumo-button-wrap submit">
            <button type="submit" class="sumo-button primary-button" name="send">{{ _('Send') }}</button>
            <input
              class="sumo-button"
              type="submit"
              id="preview-btn"
              name="preview"
              value="{{ _('Preview') }}"
              data-preview-url="{{ url('messages.preview_async') }}"
              data-preview-container-id="preview"
              data-preview-content-id="id_message" />
            <a class="sumo-button push-right" href="{{ url('messages.inbox') }}">{{ _('Cancel') }}</a>
          </div>
        </form>
      </section>
      <section id="preview" class="message-view"></section>
    </article>
    </div>
{% endblock %}
